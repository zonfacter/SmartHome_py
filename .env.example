# SmartHome Edge OS v5.0 Environment Configuration

# Sentry Error Tracking
SENTRY_DSN=""
ENVIRONMENT=development  # production, staging, development

# Application
APP_NAME=SmartHome Edge OS
APP_VERSION=5.0.0
DEBUG=False

# Resource Limiter (CPU-Throttling)
CPU_LIMIT_PERCENT=50  # CPU-Limit in Prozent (Default: 50%)
RESOURCE_CHECK_INTERVAL=5  # Prüf-Intervall in Sekunden (Default: 5s)

# Database (optional)
INFLUXDB_HOST=localhost
INFLUXDB_PORT=8086
INFLUXDB_DATABASE=smarthome

# Security
SECRET_KEY=change-me-to-a-random-secret
SMARTHOME_ADMIN_API_KEY=
# Optional: erlaubt lokale Aufrufe ohne API-Key (default: false, nur fuer Dev-Fallback aktivieren)
SMARTHOME_ALLOW_LOOPBACK_WITHOUT_KEY=false
# Rate-Limit auf kritischen Control-Endpoints (pro IP+Path)
SMARTHOME_CONTROL_RATE_LIMIT_WINDOW_SECONDS=60
SMARTHOME_CONTROL_RATE_LIMIT_MAX_REQUESTS=120
SMARTHOME_CONTROL_RATE_LIMIT_EXEMPT_LOOPBACK=true
# CORS/CSRF/Session Hardening
# Kommagetrennte Origins, z. B. http://localhost:5000,https://hmi.example.com
SMARTHOME_ALLOWED_ORIGINS=
SMARTHOME_SESSION_COOKIE_SAMESITE=Lax
SMARTHOME_SESSION_COOKIE_SECURE=false
# Basale API-Payload-Validierung
SMARTHOME_MAX_API_BODY_BYTES=1048576
SMARTHOME_MAX_API_JSON_KEYS=200
SMARTHOME_MAX_API_JSON_DEPTH=12
SMARTHOME_MAX_API_JSON_ITEMS_PER_CONTAINER=1000
SMARTHOME_MAX_API_JSON_STRING_LENGTH=8192
# Idempotency-Key Replay-Schutz für mutierende API-Requests
SMARTHOME_IDEMPOTENCY_WINDOW_SECONDS=30
SMARTHOME_IDEMPOTENCY_CACHE_MAX_ENTRIES=5000
SMARTHOME_IDEMPOTENCY_KEY_MAX_LENGTH=128

# Stream Auto-Recovery Policy
STREAM_AUTO_RECOVERY_ENABLED=true
STREAM_RECOVERY_CHECK_INTERVAL_SECONDS=2.0
STREAM_RECOVERY_MAX_RETRIES=5
STREAM_RECOVERY_COOLDOWN_SECONDS=120
STREAM_RECOVERY_BACKOFF_BASE_SECONDS=1.5
STREAM_RECOVERY_BACKOFF_MAX_SECONDS=20
STREAM_RECOVERY_JITTER_MAX_SECONDS=0.6

# Runtime Worker-/Queue-Limits
SMARTHOME_BLOB_CACHE_LIMIT_BYTES=536870912
SMARTHOME_TELEMETRY_CACHE_SIZE=10000
SMARTHOME_TELEMETRY_PRUNE_BATCH=5000
SMARTHOME_MAX_SUBSCRIBED_VARIABLES_PER_POLL=2000
SMARTHOME_DLQ_MAX_ENTRIES=1000
SMARTHOME_DLQ_REPROCESS_BATCH=50
SMARTHOME_DLQ_MAX_ATTEMPTS=5
SMARTHOME_PLC_CACHE_MAX_ENTRIES=5000
SMARTHOME_PLC_CONNECTION_CACHE_MAX_ENTRIES=5000
SMARTHOME_CAMERA_DIAG_MAX_WORKERS=12
SMARTHOME_CAMERA_SCAN_MAX_WORKERS=64
# MQTT/BT Ingress-Validierung
SMARTHOME_MQTT_MAX_TOPIC_LENGTH=256
SMARTHOME_MQTT_MAX_PAYLOAD_BYTES=65536
SMARTHOME_MQTT_MAX_JSON_DEPTH=10
SMARTHOME_MQTT_MAX_JSON_ITEMS_PER_CONTAINER=500
SMARTHOME_MQTT_MAX_JSON_STRING_LENGTH=4096
SMARTHOME_MQTT_MAX_CACHED_TOPICS=5000
SMARTHOME_BT_MAX_FRAME_BYTES=2048

# Observability SLO/SLI
SLO_WINDOW_SECONDS=3600
SLO_API_AVAILABILITY=0.995
SLO_API_P95_LATENCY_MS=500
SLO_STREAM_HEALTH_RATIO=0.99

# Audit-Log Retention
SMARTHOME_AUDIT_RETENTION_DAYS=90
SMARTHOME_AUDIT_RETENTION_MAX_ENTRIES=20000

# Backup/Restore
SMARTHOME_BACKUP_KEEP_COUNT=30
